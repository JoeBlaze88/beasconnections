<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Bea's Birthday Connections</title>
  <style>
    :root{
      --bg: linear-gradient(135deg,#ffecd2 0%, #fcb69f 20%, #a1c4fd 50%, #c2ffd8 80%, #f8b3ff 100%);
      --card: #ffffffee;
      --text: #1f2937;
      --muted: #4b5563;
      --accent: #6b21a8;
      --btn: #111827;
      --btnText: #fff;
      --good: #22c55e;
      --bad: #ef4444;
      --shadow: 0 10px 30px rgba(0,0,0,.15);
      --radius: 18px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      color:var(--text);
      background: var(--bg);
      background-attachment: fixed;
    }
    .wrap{
      max-width: 1000px; margin: 0 auto; padding: 28px 18px 64px;
    }
    header{
      display:flex; align-items:center; justify-content:space-between; gap:12px; flex-wrap:wrap;
      margin-bottom: 18px;
    }
    h1{
      font-size: clamp(24px, 3.6vw, 42px);
      line-height:1.1; margin:0; letter-spacing:.3px;
      background: linear-gradient(90deg,#111827,#334155,#6b21a8,#db2777);
      color: transparent; -webkit-background-clip: text; background-clip: text; font-weight: 900;
    }
    .card{
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 18px;
    }
    .meta{
      display:flex; gap:10px; align-items:center; flex-wrap:wrap; color:var(--muted); font-weight:600;
    }
    .pill{padding:6px 10px; border-radius:999px; background:#0000000c}

    .grid{
      display:grid; grid-template-columns: repeat(4, minmax(140px, 1fr)); gap:12px; margin-top: 14px;
    }
    @media (max-width: 720px){
      .grid{grid-template-columns: repeat(2,1fr)}
    }

    .tile{
      user-select:none; cursor:pointer;
      background:#f8fafc; border:2px solid #e2e8f0; border-radius:14px; padding:14px; font-weight:800; text-align:center; min-height:64px; display:flex; align-items:center; justify-content:center; transition:.18s transform, .18s box-shadow, .18s border-color, .18s background;
      box-shadow: 0 4px 0 #e2e8f0;
    }
    .tile:hover{ transform: translateY(-1px); box-shadow: 0 6px 0 #e2e8f0; }
    .tile.selected{ border-color:#6b21a8; background:#f3e8ff}
    .tile.correct{ background:#dcfce7; border-color:#22c55e; box-shadow: 0 4px 0 #86efac}

    .controls{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; margin-top:14px }
    button{ cursor:pointer; border:none; border-radius:12px; padding:12px 16px; font-weight:800; box-shadow: var(--shadow); background:var(--btn); color:var(--btnText); transition:.18s transform, .18s opacity }
    button.secondary{ background:#e5e7eb; color:#111827 }
    button.ghost{ background:#ffffff; color:#111827; border:1.6px solid #e5e7eb; box-shadow:none }
    button:disabled{ opacity:.55; cursor:not-allowed }

    .solved{
      display:grid; grid-template-columns: repeat(2, 1fr); gap:12px; margin-top:16px
    }
    .solved .group{
      padding:12px; border-radius:14px; color:#0b1220; font-weight:800; display:flex; flex-direction:column; gap:6px
    }
    .group small{font-weight:700; color:#0b1220cc}

    .bar{ display:flex; align-items:center; justify-content:space-between; gap:10px; margin: 12px 0 0 }
    .tries{ font-weight:800; color:#111827 }

    .next{
      display:flex; align-items:center; gap:8px; margin-top: 20px
    }

    .arrow{ font-size: 20px }

    .toast{ position:fixed; inset:auto 0 18px 0; display:flex; justify-content:center; pointer-events:none; }
    .toast > div{ background:#111827; color:#fff; padding:12px 16px; border-radius:12px; box-shadow:var(--shadow); opacity:0; transform: translateY(10px); transition:.24s }
    .toast.show > div{ opacity:1; transform: translateY(0) }

    .modal{ position: fixed; inset:0; background: rgba(0,0,0,.5); display:none; align-items:center; justify-content:center; padding:20px }
    .modal.open{ display:flex }
    .modal .panel{ background:#fff; padding:24px; border-radius:18px; max-width:520px; text-align:center; box-shadow:var(--shadow) }
    .modal h2{ margin-top:0 }

    footer{ margin-top:24px; color:#111827b3; font-weight:700; text-align:center }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Bea's Birthday Connections</h1>
      <div class="meta">
        <span class="pill" id="puzzleIndicator">Puzzle 1 of 5</span>
        <span class="pill tries" id="tries">Tries left: 4</span>
      </div>
    </header>

    <div class="card">
      <div id="board" class="grid" aria-live="polite"></div>
      <div class="controls">
        <button id="submitBtn" disabled>Submit (4)</button>
        <button id="shuffleBtn" class="secondary">Shuffle</button>
        <button id="resetBtn" class="ghost">Reset Puzzle</button>
      </div>

      <div class="solved" id="solved"></div>

      <div class="next">
        <button id="nextBtn" disabled title="Finish this puzzle to continue">Next Puzzle <span class="arrow">‚Üí</span></button>
      </div>

      <div class="bar">
        <div class="tries" id="triesBottom">Make 4 wrong guesses and it's game over!</div>
      </div>
    </div>

    <footer>Made with ‚ù§Ô∏è for Bea ¬∑ Have fun!</footer>
  </div>

  <div class="toast" id="toast"><div></div></div>

  <div class="modal" id="finalModal" role="dialog" aria-modal="true" aria-labelledby="finalTitle">
    <div class="panel">
      <h2 id="finalTitle">üéâ Congratulations, you completed all puzzles. HAPPY BIRTHDAY! üéâ</h2>
      <p>Want to play again from the start?</p>
      <button id="playAgain">Play again</button>
    </div>
  </div>

  <script>
    // ---- Game Data ---------------------------------------------------------
    const PUZZLES = [
      {
        groups: [
          { name: "All start with parts of the body", color: "#fde68a", items: ["Lunge","Headmaster","Handy","Shine"] },
          { name: "______ Table", color: "#93c5fd", items: ["Coffee","End","Poker","Pinball"] },
          { name: "Things you can peel", color: "#86efac", items: ["Paint","Orange","Skin","Rubber"] },
          { name: "Associated to October", color: "#fca5a5", items: ["Pumpkin Spice","Candy","Columbus","Mask"] },
        ]
      },
      {
        groups: [
          { name: "Things you put on your face", color: "#c4b5fd", items: ["Makeup","Goggles","Halloween mask","Sunscreen"] },
          { name: "Ends with an animal", color: "#f9a8d4", items: ["Copycat","Bookworm","Packrat","Scapegoat"] },
          { name: "First word in sodas", color: "#67e8f9", items: ["Mountain","Dr.","Root","Ginger"] },
          { name: "Words that start with basketball terms", color: "#bbf7d0", items: ["Netflix","Hoopla","Courtroom","Dunkin Donuts"] },
        ]
      },
      {
        groups: [
          { name: "Contain first names", color: "#fecaca", items: ["Drivers ed","Jack-o-lantern","Mason jar","Graham cracker"] },
          { name: "Things in our backyard", color: "#fcd34d", items: ["Connect 4","Pirate ship","Bird house","Fire pit"] },
          { name: "Palindromes", color: "#a7f3d0", items: ["Noon","Level","Kayak","Rotator"] },
          { name: "To get rid of", color: "#93c5fd", items: ["Shed","Eliminate","Scrap","Dump"] },
        ]
      },
      {
        groups: [
          { name: "Words containing numbers", color: "#86efac", items: ["Network","Canine","Freight","Content"] },
          { name: "______ Fall", color: "#fca5a5", items: ["Free","Water","Pit","Night"] },
          { name: "Things with prizes inside", color: "#fde68a", items: ["Cracker jacks","Kinder Egg","Cereal","Happy meal"] },
          { name: "Things that are salty", color: "#c4b5fd", items: ["Tears","Popcorn","Ocean","Saline Solution"] },
        ]
      },
      {
        groups: [
          { name: "Charlotte Hornets players", color: "#bbf7d0", items: ["Ball","Bridges","Knueppel","Curry"] },
          { name: "Thai restaurant orders", color: "#93c5fd", items: ["Spring Roll","Iced Tea","Drunken Noodles","Satay"] },
          { name: "Popular 90s singers' last names", color: "#fcd34d", items: ["Twain","Carey","Dion","Houston"] },
          { name: "Stephen King novels", color: "#f9a8d4", items: ["Misery","Carrie","Dreamcatcher","Insomnia"] },
        ]
      }
    ];

    // ---- Utilities --------------------------------------------------------
    const $ = (sel, root=document) => root.querySelector(sel);
    const $$ = (sel, root=document) => Array.from(root.querySelectorAll(sel));
    const shuffle = arr => arr.map(v=>[Math.random(),v]).sort((a,b)=>a[0]-b[0]).map(v=>v[1]);

    const toast = (msg) => {
      const t = $('#toast');
      t.firstElementChild.textContent = msg;
      t.classList.add('show');
      setTimeout(()=> t.classList.remove('show'), 1400);
    }

    // ---- Game State -------------------------------------------------------
    let current = 0;
    let triesLeft = 4;
    let solvedGroups = [];

    function startPuzzle(index){
      current = index;
      solvedGroups = [];
      triesLeft = 4;
      $('#puzzleIndicator').textContent = `Puzzle ${index+1} of ${PUZZLES.length}`;
      updateTries();
      renderBoard();
      renderSolved();
      $('#nextBtn').disabled = true;
    }

    function updateTries(){
      $('#tries').textContent = `Tries left: ${triesLeft}`;
      $('#triesBottom').textContent = triesLeft>1 ? `You have ${triesLeft} tries remaining.` : `Last try!`;
    }

    function currentItems(){
      const g = PUZZLES[current].groups;
      const remaining = g.filter((_,i)=>!solvedGroups.includes(i)).flatMap(gr=>gr.items);
      return shuffle(remaining);
    }

    function renderBoard(){
      const board = $('#board');
      board.innerHTML = '';
      const items = currentItems();
      for(const word of items){
        const el = document.createElement('button');
        el.className = 'tile';
        el.type = 'button';
        el.textContent = word;
        el.addEventListener('click', ()=>{
          el.classList.toggle('selected');
          enforceSelection();
        });
        board.appendChild(el);
      }
      $('#submitBtn').disabled = true;
    }

    function enforceSelection(){
      const sel = $$('.tile.selected');
      if(sel.length > 4){ sel[0].classList.remove('selected'); }
      $('#submitBtn').disabled = sel.length !== 4;
      $('#submitBtn').textContent = sel.length===4 ? 'Submit' : 'Submit (4)';
    }

    function renderSolved(){
      const host = $('#solved');
      host.innerHTML = '';
      const g = PUZZLES[current].groups;
      for(const i of solvedGroups){
        const group = g[i];
        const wrap = document.createElement('div');
        wrap.className = 'group';
        wrap.style.background = group.color;
        wrap.innerHTML = `<small>${group.name}</small><div>${group.items.join(' ¬∑ ')}</div>`;
        host.appendChild(wrap);
      }
    }

    function isCorrectSelection(selectedWords){
      const g = PUZZLES[current].groups;
      for(let i=0;i<g.length;i++){
        if(solvedGroups.includes(i)) continue;
        const set = new Set(g[i].items);
        if(selectedWords.every(w=>set.has(w))) return i;
      }
      return -1;
    }

    function removeSolvedFromBoard(words){
      const boardTiles = $$('.tile');
      for(const t of boardTiles){
        if(words.includes(t.textContent)){
          t.classList.add('correct');
          t.style.pointerEvents = 'none';
          setTimeout(()=> t.remove(), 280);
        }
      }
    }

    function checkCompletion(){
      if(solvedGroups.length === 4){
        $('#nextBtn').disabled = false;
        toast('Nice! Puzzle complete.');
        if(current === PUZZLES.length-1){
          setTimeout(()=> $('#finalModal').classList.add('open'), 350);
        }
      }
    }

    // ---- Event wiring -----------------------------------------------------
    $('#submitBtn').addEventListener('click', ()=>{
      const selected = $$('.tile.selected').map(el=>el.textContent);
      if(selected.length !== 4) return;
      const idx = isCorrectSelection(selected);
      if(idx > -1){
        solvedGroups.push(idx);
        removeSolvedFromBoard(selected);
        $$('.tile.selected').forEach(el=>el.classList.remove('selected'));
        renderSolved();
        toast('Correct group!');
        setTimeout(renderBoard, 300);
        checkCompletion();
      } else {
        triesLeft--;
        updateTries();
        toast('Not a group.');
        if(triesLeft <= 0){
          for(let i=0;i<PUZZLES[current].groups.length;i++){
            if(!solvedGroups.includes(i)) solvedGroups.push(i);
          }
          renderSolved();
          $('#board').innerHTML = '';
          $('#submitBtn').disabled = true;
          $('#nextBtn').disabled = false;
          toast('Out of tries. Puzzle over.');
        }
      }
      enforceSelection();
    });

    $('#shuffleBtn').addEventListener('click', ()=>{
      const tiles = $$('.tile');
      if(!tiles.length) return;
      renderBoard();
    });

    $('#resetBtn').addEventListener('click', ()=> startPuzzle(current));

    $('#nextBtn').addEventListener('click', ()=>{
      if(current < PUZZLES.length-1){
        startPuzzle(current+1);
      } else {
        $('#finalModal').classList.add('open');
      }
    });

    $('#playAgain').addEventListener('click', ()=>{
      $('#finalModal').classList.remove('open');
      startPuzzle(0);
    });

    startPuzzle(0);
  </script>
</body>
</html>
